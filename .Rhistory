#########
br <- read_country(showProgress = FALSE)
pol.br <- as.matrix(br$geom[[1]])
pol_br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
##
sif.005 <- sif.005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2]))
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
pol_br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
###
sif_005 <- sif.005 %>%
filter(
Lon < -30,
Lat < 10
)
###
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2]))
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
plot(pol_br)
pol_br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
plot(pol_br)
pol_br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol_br <- pol_br[!((pol_br[,1]>=-38.8 & pol_br[,1]<=-38.6) &
(pol_br[,2]>= -19 & pol_br[,2]<= -16)),]
plot(pol_br)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
###
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2]))
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2]))
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
plot(pol_br)
plot(pol_br, xlim= c(-50,-40),
ylim=c(-25,-20))
plot(pol_br, xlim= c(-46,-44),
ylim=c(-24,-22))
plot(pol_br, xlim= c(-45.75,-45),
ylim=c(-24,-22))
plot(pol_br, xlim= c(-45.75,-45),
ylim=c(-24,-23))
plot(pol_br, xlim= c(-45.75,-45),
ylim=c(-24,-23.4))
text(pol_br)
plot(pol_br, xlim= c(-45.75,-45),
ylim=c(-24,-23.4))
text(pol_br, cex=0.1)
text(pol_br, cex=1)
text(pol_br, cex=0.25)
plot(pol_br, xlim= c(-45.75,-45),
ylim=c(-24,-23.4))
text(pol_br, cex=0.25)
plot(pol_br, xlim= c(-45.6,-45.2),
ylim=c(-24,-23.4))
plot(pol_br, xlim= c(-45.5,-45.2),
ylim=c(-24,-23.4))
######
br_2 <- map_data("world", region="Brazil")
pol.br <- ggplot(br, aes(long, lat, group=group))+
geom_polygon(fill="white", colour="Black")
pol.br
pol.br <- ggplot(br_2, aes(long, lat, group=group))+
geom_polygon(fill="white", colour="Black")
pol.br
pol.br2 <- as.matrix(br_2[1:2])
plot(pol.br2)
plot(pol.br2, xlim= c(-55,-45),
ylim = c(2,-2))
plot(pol.br2, xlim= c(-55,-45),
ylim = c(5,-5))
plot(pol.br2, xlim= c(-55,-45),
ylim = c(5,-15))
#####
sif_005 %>%
ggplot(aes(Lon,Lat))+
geom_point()
pol_nordeste <- as.matrix(regiao$geom[[2]]) # pol nordeste
regiao <- read_region(showProgress = FALSE)
pol_nordeste <- as.matrix(regiao$geom[[2]]) # pol nordeste
pol_nordeste <- pol_nordeste[pol_nordeste[,1]<=-34,]# CORREÇÃO do polígono
pol_nordeste <- pol_nordeste[!((pol_nordeste[,1]>=-38.7 & pol_nordeste[,1]<=-38.6) &
pol_nordeste[,2]<= -15),]# CORREÇÃO do polígono
####
pol_br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol_br <- pol_br[!((pol_br[,1]>=-38.8 & pol_br[,1]<=-38.6) &
(pol_br[,2]>= -19 & pol_br[,2]<= -16)),]
###
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_nordeste[,1],
pol.y = pol_nordeste[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
pol_nordeste <- as.matrix(regiao$geom[[2]]) # pol nordeste
pol_nordeste <- pol_nordeste[pol_nordeste[,1]<=-34,]# CORREÇÃO do polígono
pol_nordeste <- pol_nordeste[!((pol_nordeste[,1]>=-38.7 & pol_nordeste[,1]<=-38.6) &
pol_nordeste[,2]<= -15),]# CORREÇÃO do polígono
###
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(#point.in.polygon(point.x = Lon,
#                point.y = Lat,
#               pol.x = pol_br[,1],
#              pol.y = pol_br[,2])
#|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_nordeste[,1],
pol.y = pol_nordeste[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
ggplot(br) +
theme_minimal() +
geom_point(data=sif_005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
###
sif_005 <- sif_005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_br[,1],
pol.y = pol_br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_nordeste[,1],
pol.y = pol_nordeste[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif_005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
library(raster)
library(ncdf4)
library(readxl)
library(tidyverse)
library(ggpubr)
library(geobr)
library(sp)
library(ggplot2)
setwd("C:/Users/luism/Desktop/sif_br/Nc_file/script")
getwd()
# buscar o nome do arquivo contendo os endereços
arquivo <- dir("../data/",pattern = ".nc")
n_links <- length(arquivo)
n_split <- length(str_split(arquivo[1],"/",simplify = TRUE))
nomes_arquivos <- str_split_fixed(arquivo,"/",n=Inf)[,n_split]
dir_arquivos <- paste0("../data/",nomes_arquivos)
for(i in 1:n_links){
sif.005<-brick(dir_arquivos[i])
sif.005<- as.data.frame(sif.005[[1]], xy=T)
sif.005<- na.omit(sif.005)
}
sif.005 <- sif.005%>%
mutate(
Lon=x,
Lat=y,
Sif=layer
)
###
sif.005 <- sif.005 %>%
filter(
Lon < -30,
Lat < 10
)
#########
br <- read_country(showProgress = FALSE)
region <- read_region(showProgress = FALSE)
pol.br <- as.matrix(br$geom[[1]])
pol.br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol.br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
pol_NE <- as.matrix(region$geom[[2]]) # pol nordeste
pol_NE <- pol_nordeste[pol_nordeste[,1]<=-34,]# CORREÇÃO do polígono
pol_NE <- pol_NE[!((pol_NE[,1]>=-38.7 & pol_NE[,1]<=-38.6) &
pol_NE[,2]<= -15),]# CORREÇÃO do polígono
pol_NE <- as.matrix(region$geom[[2]]) # pol nordeste
pol_NE <- pol_NE[pol_NE[,1]<=-34,]# CORREÇÃO do polígono
pol_NE <- pol_NE[!((pol_NE[,1]>=-38.7 & pol_NE[,1]<=-38.6) &
pol_NE[,2]<= -15),]# CORREÇÃO do polígono
sif.005 <- sif.005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol.br[,1],
pol.y = pol.br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_NE[,1],
pol.y = pol_NE[,2])
)
)
sif.005 <- sif.005 %>%
filter(point_in_pol != FALSE)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
test <- sif.005[!sif.005 %in% boxplot.stats(Sif)$out]
test <- sif.005[!sif.005 %in% boxplot.stats(sif.005$Sif)$out]
test %>%
ggplot(aes(y=Sif))+
geom_boxplot()
test <- sif.005[!sif.005 %in% boxplot.stats(sif.005)$out)
######
write.csv(sif, file="C:/Users/luism/Desktop/R scrips/Nc_File/SIF_2016.csv")
test <- sif.005[!sif.005 %in% boxplot.stats(sif.005)$out]
qnt <- quantile(sif.005$Sif, probs=c(.25,.75))
h <- 1.5*IQR(sif.005$Sif)
teste <- sif.005 %>%
filter(
Sif < qnt[2]-h,
Sif > qnt[1]-h
)
teste %>%
ggplot(aes(y=Sif))+
geom_boxplot()
sif.005 <- sif.005 %>%
filter(
Sif < qnt[2]-h,
Sif > qnt[1]-h
)
######
write.csv(sif, file="C:/Users/luism/Desktop/R scrips/Nc_File/SIF_2016.csv")
######
write.csv(sif.005, file="C:/Users/luism/Desktop/R scrips/Nc_File/SIF_2016.csv")
######
write.csv(sif.005, file="C:/Users/luism/Desktop/sif_br/Nc_File/SIF_2016.csv")
rm(list=ls())
setwd("C:/Users/luism/Desktop/sif_br/Nc_file/script")
getwd()
# buscar o nome do arquivo contendo os endereços
arquivo <- dir("../data/",pattern = ".nc")
n_links <- length(arquivo)
n_split <- length(str_split(arquivo[1],"/",simplify = TRUE))
nomes_arquivos <- str_split_fixed(arquivo,"/",n=Inf)[,n_split]
dir_arquivos <- paste0("../data/",nomes_arquivos)
for(i in 1:n_links){
sif.005<-brick(dir_arquivos[i])
sif.005<- as.data.frame(sif.005[[1]], xy=T)
sif.005<- na.omit(sif.005)
}
sif.005 <- sif.005%>%
mutate(
Lon=x,
Lat=y,
Sif=layer
)
###
sif.005 <- sif.005 %>%
filter(
Lon < -30,
Lat < 10
)
#########
br <- read_country(showProgress = FALSE)
region <- read_region(showProgress = FALSE)
pol.br <- as.matrix(br$geom[[1]])
pol.br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol.br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
pol_NE <- as.matrix(region$geom[[2]]) # pol nordeste
pol_NE <- pol_NE[pol_NE[,1]<=-34,]# CORREÇÃO do polígono
pol_NE <- pol_NE[!((pol_NE[,1]>=-38.7 & pol_NE[,1]<=-38.6) &
pol_NE[,2]<= -15),]# CORREÇÃO do polígono
sif.005 <- sif.005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol.br[,1],
pol.y = pol.br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_NE[,1],
pol.y = pol_NE[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
sif.005 <- sif.005 %>%
filter(point_in_pol != FALSE)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
qnt <- quantile(sif.005$Sif, probs=c(.25,.75))
h <- 1.5*IQR(sif.005$Sif)
sif.005 <- sif.005 %>%
filter(
Sif < qnt[2]-h,
Sif > qnt[1]-h
)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
######
write.csv(sif.005, file="C:/Users/luism/Desktop/sif_br/Nc_File/SIF_2015.csv")
rm(list=ls())
setwd("C:/Users/luism/Desktop/sif_br/Nc_file/script")
getwd()
# buscar o nome do arquivo contendo os endereços
arquivo <- dir("../data/",pattern = ".nc")
n_links <- length(arquivo)
n_split <- length(str_split(arquivo[1],"/",simplify = TRUE))
nomes_arquivos <- str_split_fixed(arquivo,"/",n=Inf)[,n_split]
dir_arquivos <- paste0("../data/",nomes_arquivos)
##
for(i in 1:n_links){
sif.005<-brick(dir_arquivos[i])
sif.005<- as.data.frame(sif.005[[1]], xy=T)
sif.005<- na.omit(sif.005)
}
sif.005 <- sif.005%>%
mutate(
Lon=x,
Lat=y,
Sif=layer
)
###
sif.005 <- sif.005 %>%
filter(
Lon < -30,
Lat < 10
)
#########
br <- read_country(showProgress = FALSE)
region <- read_region(showProgress = FALSE)
pol.br <- as.matrix(br$geom[[1]])
pol.br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol.br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
pol_NE <- as.matrix(region$geom[[2]]) # pol nordeste
pol_NE <- pol_NE[pol_NE[,1]<=-34,]# CORREÇÃO do polígono
pol_NE <- pol_NE[!((pol_NE[,1]>=-38.7 & pol_NE[,1]<=-38.6) &
pol_NE[,2]<= -15),]# CORREÇÃO do polígono
sif.005 <- sif.005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol.br[,1],
pol.y = pol.br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_NE[,1],
pol.y = pol_NE[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
sif.005 <- sif.005 %>%
filter(point_in_pol != FALSE)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
qnt <- quantile(sif.005$Sif, probs=c(.25,.75))
h <- 1.5*IQR(sif.005$Sif)
sif.005 <- sif.005 %>%
filter(
Sif < qnt[2]-h,
Sif > qnt[1]-h
)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
######
write.csv(sif.005, file="C:/Users/luism/Desktop/sif_br/Nc_File/SIF_2017.csv")
rm(list=ls())
setwd("C:/Users/luism/Desktop/sif_br/Nc_file/script")
getwd()
# buscar o nome do arquivo contendo os endereços
arquivo <- dir("../data/",pattern = ".nc")
n_links <- length(arquivo)
n_split <- length(str_split(arquivo[1],"/",simplify = TRUE))
nomes_arquivos <- str_split_fixed(arquivo,"/",n=Inf)[,n_split]
dir_arquivos <- paste0("../data/",nomes_arquivos)
##
for(i in 1:n_links){
sif.005<-brick(dir_arquivos[i])
sif.005<- as.data.frame(sif.005[[1]], xy=T)
sif.005<- na.omit(sif.005)
}
sif.005 <- sif.005%>%
mutate(
Lon=x,
Lat=y,
Sif=layer
)
###
sif.005 <- sif.005 %>%
filter(
Lon < -30,
Lat < 10
)
br <- read_country(showProgress = FALSE)
region <- read_region(showProgress = FALSE)
pol.br <- as.matrix(br$geom[[1]])
pol.br <- pol.br[pol.br[,1]<=-34,] # CORREÇÃO do polígono
pol.br <- pol.br[!((pol.br[,1]>=-38.8 & pol.br[,1]<=-38.6) &
(pol.br[,2]>= -19 & pol.br[,2]<= -16)),]
pol_NE <- as.matrix(region$geom[[2]]) # pol nordeste
pol_NE <- pol_NE[pol_NE[,1]<=-34,]# CORREÇÃO do polígono
pol_NE <- pol_NE[!((pol_NE[,1]>=-38.7 & pol_NE[,1]<=-38.6) &
pol_NE[,2]<= -15),]# CORREÇÃO do polígono
######
sif.005 <- sif.005 %>%
mutate(
point_in_pol = as.logical(point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol.br[,1],
pol.y = pol.br[,2])
|
point.in.polygon(point.x = Lon,
point.y = Lat,
pol.x = pol_NE[,1],
pol.y = pol_NE[,2])
)
)
ggplot(br) +
theme_minimal() +
geom_point(data=sif.005 %>% filter(point_in_pol),
aes(x=Lon,y=Lat))
sif.005 <- sif.005 %>%
filter(point_in_pol != FALSE)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
qnt <- quantile(sif.005$Sif, probs=c(.25,.75))
h <- 1.5*IQR(sif.005$Sif)
sif.005 <- sif.005 %>%
filter(
Sif < qnt[2]-h,
Sif > qnt[1]-h
)
sif.005 %>%
ggplot(aes(y=Sif))+
geom_boxplot(fill="dark green",outlier.colour = "black")+
coord_cartesian(xlim=c(-1,1))+
theme_classic()
######
write.csv(sif.005, file="C:/Users/luism/Desktop/sif_br/Nc_File/SIF_2018.csv")
